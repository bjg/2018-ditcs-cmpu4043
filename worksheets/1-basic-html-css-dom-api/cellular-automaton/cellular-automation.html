<!DOCTYPE html>
<html>
    <head>
        <title>Cellular Automation</title>
    </head>
    <body>
        <script>
            const num_cols = 101;
            const num_rows = 50;
            //can be changed more easily if desired
            cell_width = 8;
            cell_height = 8;
            //I find variable names more readable than string values
            active = "active";
            inactive = "inactive";
    

            //creates and returns a new state coloured either green or white depending on the value of state (if the cell should be active or not)
            function generate_cell(state) {
                cell = document.createElement('div');
                cell.style.width = cell_width.toString()+"px";
                cell.style.height = cell_height.toString()+"px";
                cell.style.border = "1px solid black";
                cell.style.display = "inline-block";
                cell.style.margin = "0 1px 0 1px";
                if(state === active) {
                    cell.style.backgroundColor = 'green';
                }
                else {
                    cell.style.backgroundColor = 'white';
                }
    
                return cell;
            }//end generate_cell()


            //used to generate the first row. ~50% chance of generating an active cell. Fun to play with the value of the if condition
            function get_random_state() {
                if(Math.random() < 0.5) {
                    return active;
                }
                else return inactive;
            }//end get_random_state()


            //returns an empty div (row) to be populated with cells
            function row_template() {
                row = document.createElement('div');
                row.width = (num_cols * cell_width).toString()+"px";
                row.height = cell_height.toString()+"px";
                return row;
            }//end row_template()


            //generates the first row of cells whos active states are randomly generated
            function init_row() {
                row = row_template();
                for(i=0; i<num_cols; i++) {
                    cell = generate_cell(get_random_state());
                    row.appendChild(cell);
                }
                return row;
            }//end init_row()


            //determines if a new cell should be active or not based on the active state of the cells in the previous row at its index, its index-1 and its index+1
            function get_new_cell_state(left_cell, middle_cell, right_cell) {
                if(
                    (left_cell.style.backgroundColor === 'green' && middle_cell.style.backgroundColor === 'white' && right_cell.style.backgroundColor === 'green')
                    ||
                    (left_cell.style.backgroundColor === 'green' && middle_cell.style.backgroundColor === 'white' && right_cell.style.backgroundColor === 'white')
                    ||
                    (left_cell.style.backgroundColor === 'white' && middle_cell.style.backgroundColor === 'green' && right_cell.style.backgroundColor === 'green') 
                    ||
                    (left_cell.style.backgroundColor === 'white' && middle_cell.style.backgroundColor === 'green' && right_cell.style.backgroundColor === 'white')
                  ) 
                {
                    return active;
                }
                else 
                {
                    return inactive;
                }
            }//end get_new_cell_state()


            //gets the next row in the grid with cell active states depending on the active states of the cells in the previous rows
            function get_next_row(prev_row) {
                //get all cells from previous row
                prev_cells = prev_row.querySelectorAll('div');
                new_row = row_template();
                for(index=0; index<num_cols; index++) {
                    if(index === 0) {
                        direct_ancestor_left_index = num_cols-1;
                        direct_ancestor_right_index = 1;
                    }
                    else if(index === num_cols-1) {
                        direct_ancestor_right_index = 0;
                        direct_ancestor_left_index = num_cols-2;
                    }
                    else {
                        direct_ancestor_left_index = index-1;
                        direct_ancestor_right_index = index+1;
                    }
                    //abstracted cell state here for readability and to reduce complexity
                    cell_state = get_new_cell_state(prev_cells[direct_ancestor_left_index], prev_cells[index], prev_cells[direct_ancestor_right_index]);
                    cell = generate_cell(cell_state);
                    new_row.appendChild(cell);
                }

                return new_row;
            }//end get_next_row()


            //use recursion to generate final grid
            function generate_grid(p_row, r_count) {
                if(r_count === num_rows) {
                    return;
                }
                else {
                    document.body.appendChild(p_row);
                    n_row = get_next_row(p_row);
                    generate_grid(n_row, r_count+1);
                }
            }//end generate_grid()

            //draw the grid
            generate_grid(init_row(), 0);
        </script>
    </body>
</html>